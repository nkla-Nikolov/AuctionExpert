function adminAuctionsPerPage(n){let t=parseInt($(n.target).parent().find(".option.selected").attr("data-value"));$.ajax({type:"get",data:{itemsPerPage:t},url:"/Administration/Auction/All",success:function(){}})}function makeAdmin(n){n.preventDefault();let t=$(n.target).attr("data-userId"),i=$("#antiForgeryForm input").val();$.ajax({type:"post",data:{userId:t},url:"/Administration/User/AddToRole",headers:{"X-CSRF-TOKEN":i},success:function(t){t.success&&($(n.target).removeClass("btn-outline-success"),$(n.target).addClass("btn-outline-danger"),$(n.target).text("Remove Admin"),$(n.target).attr("onclick","removeAdmin(event)"))}})}function removeAdmin(n){n.preventDefault();let t=$(n.currentTarget).attr("data-userId"),i=$("#antiForgeryForm input").val();$.ajax({type:"post",data:{userId:t},url:"/Administration/User/RemoveFromRole",headers:{"X-CSRF-TOKEN":i},success:function(t){t.success&&($(n.target).removeClass("btn-outline-danger"),$(n.target).addClass("btn-outline-success"),$(n.target).text("Make Admin"),$(n.target).attr("onclick","makeAdmin(event)"))}})}function searchUser(n){let t=$(n.target).val();t.length>1?$.ajax({type:"GET",url:"/Administration/User/GetAllBySearchTerm",data:{searchTerm:t},success:function(n){$("#users-table tbody").empty();updateTable("user",n);$(".table-pagination").hide()}}):(loadUsersIntoTable(),$(".table-pagination").show())}function searchCountry(n){let t=$(n.target).val();t.length>1?$.ajax({type:"GET",url:"/Administration/Country/GetAllBySearchTerm",data:{name:t},success:function(n){$("#countries-table tbody").empty();updateTable("country",n);$(".table-pagination").hide()}}):t.length==0&&(loadCountriesIntoTable(),$(".table-pagination").show())}function addCountry(){let n=$("#addCountryName").val();if(n.length==0){$("#addCountryName").addClass("is-invalid");$(".invalid-feedback").css("display","block").css("font-size","16px");return}$(".invalid-feedback").css("display","none");$("#addCountryName").removeClass("is-invalid");let t=$("#antiForgeryForm input").val();$.ajax({type:"POST",url:"/Administration/Country/Add",data:{countryName:n},headers:{"X-CSRF-TOKEN":t},success:function(n){n.success||alert(n.errorMessage)},error:function(){alert("Request failed. Please try again")},complete:function(){$("#addCountryName").val("")}})}function adminUsersPerPage(n){n.preventDefault();let t=parseInt($(n.currentTarget).parent().find(".selected").attr("data-value")),i={itemsPerPage:t,currentPage:1};loadUsersIntoTable(i)}function loadUsersIntoTable(n){n==null&&(n={itemsPerPage:10,currentPage:1});$.ajax({type:"get",url:"/Administration/User/GetAll",data:n,success:function(n){n.success&&($("#users-table tbody").empty(),updateTable("user",n.users),n.pagesCount>1&&pagination(n,"adminUsersPagination",loadUsersIntoTable))}})}function adminCountriesPerPage(n){n.preventDefault();let t=parseInt($(n.currentTarget).siblings().find(".option.selected").attr("data-value")),i={itemsPerPage:t,currentPage:1};loadCountriesIntoTable(i)}function loadCountriesIntoTable(n){n==null&&(n={itemsPerPage:10,currentPage:1});$.ajax({type:"GET",url:"/Administration/Country/GetAll",data:n,success:function(n){$("#countries-table tbody").empty();$(".pagination").empty();updateTable("country",n.countries);n.pagesCount>1&&pagination(n,"adminCountriesPagination",loadCountriesIntoTable)}})}function pagination(n,t,i){let c=$(`#${t}`),r=$(document.createDocumentFragment()),u=$(document.createElement("li"));$(u).addClass("page-item");let f=$(document.createElement("a"));$(f).addClass("page-link");$(f).text("Prev");n.hasPreviousPage?$(f).attr("data-pageNumber",n.currentPage-1):$(u).addClass("disabled");$(u).append(f);$(r).append(u);for(let t=n.currentPage-3;t<n.currentPage;t++)if(t>0){let n=$(document.createElement("li"));$(n).addClass("page-item");let i=$(document.createElement("a"));$(i).addClass("page-link");$(i).text(t);$(n).append(i);$(r).append(n)}let e=$(document.createElement("li"));$(e).addClass(["page-item","active"]);$(e).attr("aria-current","page");let h=$(document.createElement("a"));$(h).addClass("page-link");$(h).text(n.currentPage);$(e).append(h);$(r).append(e);for(let t=n.currentPage+1;t<=n.currentPage+2;t++)if(t<=n.pagesCount){let n=$(document.createElement("li"));$(n).addClass("page-item");let i=$(document.createElement("a"));$(i).addClass("page-link");$(i).text(t);$(n).append(i);$(r).append(n)}let o=$(document.createElement("li"));$(o).addClass("page-item");let s=$(document.createElement("a"));$(s).addClass("page-link");$(s).text("Next");n.hasNextPage?$(s).attr("data-pageNumber",n.currentPage+1):$(o).addClass("disabled");$(o).append(s);$(r).append(o);$(c).append(r);let l=$(".page-item");$(l).each(function(t,r){$(r).click(function(t){if(t.preventDefault(),!$(t.currentTarget).hasClass("disabled")){let r=Number($(t.currentTarget).children().text());if(isNaN(r)&&(r=Number($(t.currentTarget).children().first().attr("data-pagenumber"))),r!=n.currentPage){let t={currentPage:r,itemsPerPage:n.itemsPerPage};i(t)}}})})}function updateTable(n,t){let i=$(document.createDocumentFragment());n=="country"?($(t).each(function(n,t){let r=createCountryRow(t);$(i).append(r)}),$("#countries-table tbody").append(i)):n=="user"&&($(t).each(function(n,t){let r=createUserRow(t);$(i).append(r)}),$("#users-table tbody").append(i))}function createCountryRow(n){return`<tr>
        <td data-label="Country ID">${n.id}</td>
        <td data-label="Country name">${n.name}</td>
        <td data-label="Cities count">${n.citiesCount}</td>
        <td data-label="Delete">
          <button onclick="deleteCountryButtonHandler(event)" class="btn btn-sm btn-outline-danger" id="delete-country_${n.id}">Delete</button>
        </td>
        <td data-label="Edit">
          <button onclick="editCountryButtonHandler(event)" class="btn btn-sm btn-outline-warning" id="edit-country_${n.id}">Edit</button>
        </td>
    </tr>`}function createUserRow(n){let t=`<tr>
                <td data-label="Username">${n.username}</td>
                <td data-label="Email">${n.email}</td>
                <td data-label="Join Date">${n.createdOn}</td>
                <td data-label="Auctions Count">${n.auctionsCount}</td>
                <td data-label="Profile"><a href="/User/SellerProfile/${n.id}" class="btn btn-sm btn-outline-secondary">Profile page</a></td>`;return t+=n.isAdmin?`<td data-label="Manage Roles">
                                            <button onclick="removeAdmin(event)" data-userId="${n.id}" class="btn btn-sm btn-outline-danger">
                                                Remove Admin
                                            </button>
                                    </td>`:`<td data-label="Manage Roles">
                                            <button onclick="makeAdmin(event)" data-userId="${n.id}" class="btn btn-sm btn-outline-success">
                                                Make Admin
                                            </button>
                                    </td>`,t+`</tr>`}function deleteCountryButtonHandler(n){let t=$(n.target).attr("id"),i=t.indexOf("_"),r=Number(t.substring(i+1)),u=$("#antiForgeryForm input").val(),f={countryId:r};$.ajax({type:"POST",url:"/Administration/Country/Delete",data:f,headers:{"X-CSRF-TOKEN":u},success:function(t){t.result?$(n.target).parent().parent().remove():alert("Country does not exist!")},error:function(){alert("Request failed. Please try again")}})}function editCountryButtonHandler(n){$(n.target).attr("disabled","disabled");let e=$(n.target).attr("id"),s=e.indexOf("_"),h=Number(e.substring(s+1)),c=$("#antiForgeryForm input").val(),i=$(n.target).parent().parent().children()[1],o=$(i).text();$(i).text("");let r=$(document.createElement("div"));$(r).addClass("d-flex");$(r).css("margin","auto");let f=$(document.createElement("input"));$(f).addClass("form-control");$(f).val(o);let u=$(document.createElement("button"));$(u).addClass(["btn","btn-sm","btn-outline-success"]);$(u).css("margin-left","20px");$(u).text("Update");let t=$(document.createElement("button"));$(t).addClass(["btn","btn-sm","btn-outline-danger"]);$(t).css("margin-left","20px");$(t).text("Cancel");$(r).append(f);$(r).append(u);$(r).append(t);$(i).append(r);$(u).click(function(n){n.preventDefault();let u=$(this).parent().children()[0],r=$(u).val(),f={countryId:h,countryName:r};$.ajax({type:"POST",url:"/Administration/Country/Update",data:f,headers:{"X-CSRF-TOKEN":c},success:function(n){n.result?($(t).trigger("click"),i.textContent=r):(alert(n.message),$(t).trigger("click"))},error:function(){alert("Request failed. Please try again");$(t).trigger("click")}})});$(t).click(function(){$(i).empty();$(i).text(o);$(n.target).removeAttr("disabled")})}function updateCountryButtonHandler(n){n.preventDefault();let i=$(this).parent().children()[0],t=$(i).val,r={countryId,countryName:t};$.ajax({type:"POST",url:"/Administration/Country/Update",data:r,headers:{"X-CSRF-TOKEN":token},success:function(n){n.result?($(cancelBtn).trigger("click"),tdElement.textContent=t):(alert(n.message),$(cancelBtn).trigger("click"))},error:function(){alert("Request failed. Please try again");$(cancelBtn).trigger("click")}})}function getTimers(){let n=0,i=[],t=document.querySelector(`#timer${n}`);while(t!=null)i.push(t),n++,t=document.querySelector(`#timer${n}`);return i}function deleteAuction(n){var t=$("#antiForgeryForm input").val();$.ajax({type:"POST",data:{id:n},url:"/Auction/DeleteAuction",headers:{"X-CSRF-TOKEN":t},success:function(t){t.success&&location.href.endsWith(n)&&(location.href="/Home/Index")}})}function countDown(){let n=getTimers();if(n.length!=0)for(let t=0;t<n.length;t++){let h=document.querySelector(`#timer${t}`).getAttribute("data-enddate"),c=new Date(h).getTime(),l=(new Date).getTime(),n=c-l,u=1e3,i=u*60,r=i*60,f=r*24,e=Math.floor(n/f),o=Math.floor(n%f/r),s=Math.floor(n%r/i),a=Math.floor(n%i/u);if(e<1&&o<1&&s<6){let n=document.querySelector(`#timer${t}`).getAttribute("data-auctionId");deleteAuction(n)}document.querySelector(`#days${t}`).textContent=e;document.querySelector(`#hours${t}`).textContent=o;document.querySelector(`#minutes${t}`).textContent=s;document.querySelector(`#seconds${t}`).textContent=a}}function getSubCategories(n){n.preventDefault();let t=Number($(n.currentTarget).children(".nice-select").children(".list").children(".selected").attr("data-value"));if($("#loadSubCategoryId").children(".nice-select").children(".list").empty(),$("#editAuctionGetSubCategoryId").children(".nice-select").children(".list").empty(),$("#loadSubCategoryId").children().find("span.current").text("Select subcategory"),$("#editAuctionGetSubCategoryId").children().find("span.current").text("Select subcategory"),!Number.isInteger(t)){$("#loadSubCategoryId").parent().css("display","none");return}$.ajax({type:"get",url:"/SubCategory/GetSubCategoriesByCategoryId",data:{categoryId:t},success:function(n){if(n.success){let t=$(document.createDocumentFragment());$(n.subCategories).each(function(n,i){let r=$(document.createElement("li"));$(r).addClass("option");$(r).attr("data-value",i.id);$(r).text(i.name);t.append(r)});location.href.includes("Edit")?($("#editAuctionGetSubCategoryId").children(".nice-select").children(".list").append(t),$("#editAuctionGetSubCategoryId").parent().css("display","block")):($("#loadSubCategoryId").children(".nice-select").children(".list").append(t),$("#loadSubCategoryId").parent().css("display","block"))}else alert(n.errorMessage)},error:function(){alert("Request failed. Please try again later")}})}function getSubCategoryId(n){n.preventDefault();let t=Number($(n.currentTarget).children(".nice-select").children(".list").children(".selected").attr("data-value"));$(n.currentTarget).children("select").children().val(t)}function openModal(){document.getElementById("myModal").style.display="block";document.querySelector("body").style.overflow="hidden"}function closeModal(){document.getElementById("myModal").style.display="none";document.querySelector("body").style.overflow="visible"}function plusSlides(n){showSlides(slideIndex+=n)}function currentSlide(n){showSlides(slideIndex=n)}function showSlides(n){var t,i=document.getElementsByClassName("mySlides"),r=document.getElementsByClassName("demo"),u=document.getElementById("caption");for(n>i.length&&(slideIndex=1),n<1&&(slideIndex=i.length),t=0;t<i.length;t++)i[t].style.display="none";for(t=0;t<r.length;t++)r[t].className=r[t].className.replace(" active","");i[slideIndex-1].style.display="block";r[slideIndex-1].className+=" active";u.innerHTML=r[slideIndex-1].alt}function openModal(){document.getElementById("myModal").style.display="block";document.querySelector("body").style.overflow="hidden"}function closeModal(){document.getElementById("myModal").style.display="none";document.querySelector("body").style.overflow="visible"}function plusSlides(n){showSlides(slideIndex+=n)}function currentSlide(n){showSlides(slideIndex=n)}function showSlides(n){var t=document.getElementsByClassName("mySlides"),i=document.getElementsByClassName("demo"),r=document.getElementById("caption");n>t.length&&(slideIndex=1);n<1&&(slideIndex=t.length);for(let n=0;n<t.length;n++)t[n].style.display="none";for(let n=0;n<i.length;n++)i[n].className=i[n].className.replace(" active","");t[slideIndex-1]!=undefined&&(t[slideIndex-1].style.display="block");i[slideIndex-1]!=undefined&&(i[slideIndex-1].className+=" active",r.innerHTML=i[slideIndex-1].alt)}function likeAuction(n,t,i){$.ajax({type:"POST",url:"/Auction/LikeAuction",data:n,headers:{"X-CSRF-TOKEN":t},success:function(n){n.result&&($(i.target).removeClass("bi-heart"),$(i.target).addClass("bi-heart-fill"))}})}function dislikeAuction(n,t,i){$.ajax({type:"POST",url:"/Auction/DislikeAuction",data:n,headers:{"X-CSRF-TOKEN":t},success:function(n){n.result&&($(i.target).removeClass("bi-heart-fill"),$(i.target).addClass("bi-heart"))}})}function likeAuctionHandler(n){n.preventDefault();let r=$(this).parent().attr("data-auctionid"),t=$("#antiForgeryForm input").val();var i={auctionId:r};$.ajax({type:"GET",url:"/Auction/DoesUserLikeCurrentAuction",data:i,headers:{"X-CSRF-TOKEN":t},success:function(r){r?dislikeAuction(i,t,n):likeAuction(i,t,n)}})}var slideIndex;$(document).ready(function(){$("select").niceSelect();setInterval(countDown,1e3);$(".like i").click(likeAuctionHandler);$("#loadSubCategories").change(getSubCategories);$("#loadSubCategoryId").change(getSubCategoryId);$("#adminCountriesPerPage").change(adminCountriesPerPage);$("#adminUsersPerPage").change(adminUsersPerPage);$("#editAuctionGetSubCategories").change(getSubCategories);$("#editAuctionGetSubCategoryId").change(getSubCategoryId);$("#addCountry").click(addCountry);$("#search-country").on("input",searchCountry);$("#search-user").on("input",searchUser);$("#select-auctions-per-page").change(adminAuctionsPerPage)});slideIndex=1;showSlides(slideIndex);slideIndex=1;showSlides(slideIndex);