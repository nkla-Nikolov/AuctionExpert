function adminCountriesPerPage(n){n.preventDefault();let t=Number($(n.currentTarget).children(".nice-select").children(".list").children(".selected").attr("data-value")),i={itemsPerPage:t,currentPage:1};loadCountries(i)}function loadCountries(n){n==null&&(n={itemsPerPage:10,currentPage:1});$.ajax({type:"GET",url:"/Administration/Countries/GetAll",data:n,success:function(n){$("#countries-table tbody").empty();$(".pagination").empty();updateTable(n.countries);pagination(n)}})}function pagination(n){let s=$("#adminCountriesPagination"),t=$(document.createDocumentFragment()),i=$(document.createElement("li"));$(i).addClass("page-item");let r=$(document.createElement("a"));$(r).addClass("page-link");$(r).text("Prev");n.hasPreviousPage?$(r).attr("data-pageNumber",n.currentPage-1):$(i).addClass("disabled");$(i).append(r);$(t).append(i);for(let i=n.currentPage-3;i<n.currentPage;i++)if(i>0){let n=$(document.createElement("li"));$(n).addClass("page-item");let r=$(document.createElement("a"));$(r).addClass("page-link");$(r).text(i);$(n).append(r);$(t).append(n)}let u=$(document.createElement("li"));$(u).addClass("page-item","active");$(u).attr("aria-current","page");let o=$(document.createElement("a"));$(o).addClass("page-link");$(o).text(n.currentPage);$(u).append(o);$(t).append(u);for(let i=n.currentPage+1;i<=n.currentPage+2;i++)if(i<=n.pagesCount){let n=$(document.createElement("li"));$(n).addClass("page-item");let r=$(document.createElement("a"));$(r).addClass("page-link");$(r).text(i);$(n).append(r);$(t).append(n)}let f=$(document.createElement("li"));$(f).addClass("page-item");let e=$(document.createElement("a"));$(e).addClass("page-link");$(e).text("Next");n.hasNextPage?$(e).attr("data-pageNumber",n.currentPage+1):$(f).addClass("disabled");$(f).append(e);$(t).append(f);$(s).append(t);let h=$(".page-item");$(h).each(function(n,t){$(t).click(function(n){if(n.preventDefault(),!$(n.currentTarget).hasClass("disabled")){let t=Number($(n.currentTarget).children().text());isNaN(t)&&(t=Number($(n.currentTarget).children().first().attr("data-pagenumber")));let i=Number($("#adminCountriesPerPage").children(".nice-select").children(".list").children(".selected").attr("data-value")),r={currentPage:t,itemsPerPage:i};loadCountries(r)}})})}function updateTable(n){let t=$(document.createDocumentFragment());$(n).each(function(n,i){let r=$(document.createElement("tr")),e=$(document.createElement("td"));$(e).attr("data-label","Country ID");$(e).text(i.id);let o=$(document.createElement("td"));$(o).attr("data-label","Country name");$(o).text(i.name);let s=$(document.createElement("td"));$(s).attr("data-label","Cities count");$(s).text(i.citiesCount);let h=$(document.createElement("td"));$(h).attr("data-label","Delete");let u=$(document.createElement("button"));$(u).text("Delete");$(u).addClass(["btn","btn-sm","btn-outline-danger"]);$(u).prop("id",`delete-country_${i.id}`);$(u).click(deleteButtonHandler);$(h).append(u);let c=$(document.createElement("td"));$(c).attr("data-label","Edit");let f=$(document.createElement("button"));$(f).text("Edit");$(f).addClass(["btn","btn-sm","btn-outline-warning"]);$(f).prop("id",`edit-country_${i.id}`);$(f).click(editButtonHandler);$(c).append(f);$(r).append(e);$(r).append(o);$(r).append(s);$(r).append(h);$(r).append(c);$(t).append(r)});$("#countries-table tbody").append(t)}function deleteButtonHandler(n){let t=$(n.target).attr("id"),i=t.indexOf("_"),r=Number(t.substring(i+1)),u=$("#antiForgeryForm input").val(),f={countryId:r};$.ajax({type:"POST",url:"/Administration/Countries/Delete",data:f,headers:{"X-CSRF-TOKEN":u},success:function(t){t.result?$(n.target).parent().parent().remove():alert("Country does not exist!")},error:function(){alert("Request failed. Please try again")}})}function editButtonHandler(n){$(n.target).attr("disabled","disabled");let e=$(n.target).attr("id"),s=e.indexOf("_"),h=Number(e.substring(s+1)),c=$("#antiForgeryForm input").val(),i=$(this).parent().parent().children()[1],o=$(i).text();$(i).text("");let r=$(document.createElement("div"));$(r).addClass("d-flex");$(r).css("margin","auto");let f=$(document.createElement("input"));$(f).addClass("form-control");$(f).val(o);let u=$(document.createElement("button"));$(u).addClass(["btn","btn-sm","btn-outline-success"]);$(u).css("margin-left","20px");$(u).text("Update");let t=$(document.createElement("button"));$(t).addClass(["btn","btn-sm","btn-outline-danger"]);$(t).css("margin-left","20px");$(t).text("Cancel");$(r).append(f);$(r).append(u);$(r).append(t);$(i).append(r);$(u).click(function(n){n.preventDefault();let u=$(this).parent().children()[0],r=$(u).val(),f={countryId:h,countryName:r};$.ajax({type:"POST",url:"/Administration/Countries/Update",data:f,headers:{"X-CSRF-TOKEN":c},success:function(n){n.result?($(t).trigger("click"),i.textContent=r):(alert(n.message),$(t).trigger("click"))},error:function(){alert("Request failed. Please try again");$(t).trigger("click")}})});$(t).click(function(){$(i).empty();$(i).text(o);$(n.target).removeAttr("disabled")})}function getTimers(){let n=0,i=[],t=document.querySelector(`#timer${n}`);while(t!=null)i.push(t),n++,t=document.querySelector(`#timer${n}`);return i}function deleteAuction(n){var t=document.querySelector("#antiForgeryForm input").value;fetch(`/api/ApiAuction/?id=${n}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":t}}).then(n=>{if(!n.ok)throw new Error("Something went wrong");}).then(()=>{window.location.href.endsWith(n)?window.location.href="https://localhost:44319/":window.location.reload()})}function countDown(){let n=getTimers();if(n.length!=0)for(let t=0;t<n.length;t++){let h=document.querySelector(`#timer${t}`).getAttribute("data-enddate"),c=new Date(h).getTime(),l=(new Date).getTime(),n=c-l,u=1e3,i=u*60,r=i*60,f=r*24,e=Math.floor(n/f),o=Math.floor(n%f/r),s=Math.floor(n%r/i),a=Math.floor(n%i/u);if(e<1&&o<1&&s<6){let n=document.querySelector(`#timer${t}`).getAttribute("data-auctionId");deleteAuction(n)}document.querySelector(`#days${t}`).textContent=e;document.querySelector(`#hours${t}`).textContent=o;document.querySelector(`#minutes${t}`).textContent=s;document.querySelector(`#seconds${t}`).textContent=a}}function getSubCategories(n){n.preventDefault();let t=Number($(n.currentTarget).children(".nice-select").children(".list").children(".selected").attr("data-value"));if($("#loadSubCategoryId").children(".nice-select").children(".list").empty(),!Number.isInteger(t)){$("#loadSubCategoryId").parent().css("display","none");return}$.ajax({type:"get",url:"/SubCategory/GetSubCategoriesByCategoryId",data:{categoryId:t},success:function(n){if(n.success){let t=$(document.createDocumentFragment());$(n.subCategories).each(function(n,i){let r=$(document.createElement("li"));$(r).addClass("option");$(r).attr("data-value",i.id);$(r).text(i.name);t.append(r)});$("#loadSubCategoryId").children(".nice-select").children(".list").append(t);$("#loadSubCategoryId").parent().css("display","block")}else alert(n.errorMessage)},error:function(){alert("Request failed. Please try again later")}})}function getSubCategoryId(n){n.preventDefault();let t=Number($(n.currentTarget).children(".nice-select").children(".list").children(".selected").attr("data-value"));$(n.currentTarget).children("select").children().val(t)}function openModal(){document.getElementById("myModal").style.display="block";document.querySelector("body").style.overflow="hidden"}function closeModal(){document.getElementById("myModal").style.display="none";document.querySelector("body").style.overflow="visible"}function plusSlides(n){showSlides(slideIndex+=n)}function currentSlide(n){showSlides(slideIndex=n)}function showSlides(n){var t,i=document.getElementsByClassName("mySlides"),r=document.getElementsByClassName("demo"),u=document.getElementById("caption");for(n>i.length&&(slideIndex=1),n<1&&(slideIndex=i.length),t=0;t<i.length;t++)i[t].style.display="none";for(t=0;t<r.length;t++)r[t].className=r[t].className.replace(" active","");i[slideIndex-1].style.display="block";r[slideIndex-1].className+=" active";u.innerHTML=r[slideIndex-1].alt}function openModal(){document.getElementById("myModal").style.display="block";document.querySelector("body").style.overflow="hidden"}function closeModal(){document.getElementById("myModal").style.display="none";document.querySelector("body").style.overflow="visible"}function plusSlides(n){showSlides(slideIndex+=n)}function currentSlide(n){showSlides(slideIndex=n)}function showSlides(n){var t=document.getElementsByClassName("mySlides"),i=document.getElementsByClassName("demo"),r=document.getElementById("caption");n>t.length&&(slideIndex=1);n<1&&(slideIndex=t.length);for(let n=0;n<t.length;n++)t[n].style.display="none";for(let n=0;n<i.length;n++)i[n].className=i[n].className.replace(" active","");t[slideIndex-1]!=undefined&&(t[slideIndex-1].style.display="block");i[slideIndex-1]!=undefined&&(i[slideIndex-1].className+=" active",r.innerHTML=i[slideIndex-1].alt)}function likeAuction(n,t,i){$.ajax({type:"POST",url:"/Auction/LikeAuction",data:n,headers:{"X-CSRF-TOKEN":t},success:function(n){n.result==!0&&(i.target.classList.remove("bi-heart"),i.target.classList.add("bi-heart-fill"))}})}function dislikeAuction(n,t,i){$.ajax({type:"POST",url:"/Auction/DislikeAuction",data:n,headers:{"X-CSRF-TOKEN":t},success:function(n){n.result==!0&&(i.target.classList.remove("bi-heart-fill"),i.target.classList.add("bi-heart"))}})}function likeAuctionHandler(n){n.preventDefault();let r=$(this).parent().attr("data-auctionid"),t=$("#antiForgeryForm input").val();var i={auctionId:r};$.ajax({type:"GET",url:"/Auction/DoesUserLikeCurrentAuction",data:i,headers:{"X-CSRF-TOKEN":t},success:function(r){r?dislikeAuction(i,t,n):likeAuction(i,t,n)}})}var slideIndex;$(document).ready(function(){setInterval(countDown,1e3);$(".like i").click(likeAuctionHandler);$("#loadSubCategories").change(getSubCategories);$("#loadSubCategoryId").change(getSubCategoryId);$("#adminCountriesPerPage").change(adminCountriesPerPage)});slideIndex=1;showSlides(slideIndex);slideIndex=1;showSlides(slideIndex);